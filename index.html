<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>오늘의 지혜 한 문장</title>

    <!-- SEO -->
    <meta
      name="description"
      content="성경의 메시지에서 영감을 받은 하루 한 문장. 짧고 단단한 문장으로 하루를 정돈하세요."
    />
    <meta
      name="keywords"
      content="오늘의 지혜, 하루 한 문장, 묵상, 마음정리, 영감 문장"
    />
    <meta name="robots" content="index,follow" />
    <link rel="canonical" href="https://wisdom.funnyfunny.cloud/" />

    <!-- Open Graph (og-image text MUST be English) -->
    <meta property="og:title" content="Daily Wisdom" />
    <meta
      property="og:description"
      content="성경 메시지에서 영감을 받은 하루 한 문장, 현대 한국어로 전합니다."
    />
    <meta
      property="og:image"
      content="https://dummyimage.com/1200x630/0b1220/ffffff&text=Daily+Wisdom"
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://wisdom.funnyfunny.cloud/" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Daily Wisdom" />
    <meta
      name="twitter:description"
      content="성경 메시지에서 영감을 받은 하루 한 문장, 현대 한국어로 전합니다."
    />
    <meta
      name="twitter:image"
      content="https://dummyimage.com/1200x630/0b1220/ffffff&text=Daily+Wisdom"
    />

    <!-- Favicon (auto-generated SVG) -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0%25' y1='100%25' x2='100%25' y2='0%25'%3E%3Cstop offset='0%25' stop-color='%230b1220'/%3E%3Cstop offset='100%25' stop-color='%2322c55e'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='14' fill='url(%23g)'/%3E%3Cpath d='M18 22h28a6 6 0 0 1 6 6v14a6 6 0 0 1-6 6H18a6 6 0 0 1-6-6V28a6 6 0 0 1 6-6Z' fill='rgba(255,255,255,0.10)' stroke='%23bbf7d0' stroke-width='2'/%3E%3Cpath d='M22 30h10M22 36h20M22 42h16' stroke='%23e9fff3' stroke-width='2.5' stroke-linecap='round'/%3E%3C/svg%3E"
    />

    <script src="https://cdn.tailwindcss.com"></script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1204894220949193"
     crossorigin="anonymous"></script>
    <!-- responsive-base -->
    <style>
      /* responsive-base */
      *, *::before, *::after {
        box-sizing: border-box;
      }
      html {
        -webkit-text-size-adjust: 100%;
      }
      img,
      video,
      canvas,
      svg {
        max-width: 100%;
        height: auto;
      }
      table {
        width: 100%;
      }
      pre,
      code {
        white-space: pre-wrap;
        word-break: break-word;
      }
    </style>
  <style>
    .adsense-block {
      margin: 16px 0;
      display: flex;
      justify-content: center;
    }
    .adsbygoogle {
      display: block;
      margin: 16px auto;
        text-align: center;
}
    .lang-switch {
      display: inline-flex;
      gap: 6px;
      padding: 4px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.16);
    }
    .lang-switch button {
      border: none;
      background: transparent;
      color: rgba(255, 255, 255, 0.7);
      font-size: 12px;
      font-weight: 700;
      padding: 6px 12px;
      border-radius: 999px;
      cursor: pointer;
      letter-spacing: 0.08em;
    }
    .lang-switch button.active {
      background: #22c55e;
      color: #0b1120;
    }
  </style>
</head>

  <body
    class="min-h-screen bg-gradient-to-b from-slate-950 to-slate-900 text-white"
  >
    <main class="max-w-3xl mx-auto px-4 py-10">
      <div class="flex items-center justify-between mb-4 gap-3">
        <div class="lang-switch" role="tablist" aria-label="Language switcher">
          <button type="button" data-lang="ko" class="active">KR</button>
          <button type="button" data-lang="en">EN</button>
        </div>
        <a
          href="https://funnyfunny.cloud/"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 px-4 py-2 bg-white/10 hover:bg-white/15 border border-white/15 text-white rounded-lg font-medium transition-colors duration-200"
          data-i18n="viewMore"
        >
          다른 서비스 보기
        </a>
      </div>
      
      <!-- Header -->
      <header class="text-center mb-8">
        <div
          class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10"
        >
          <span class="text-emerald-300 text-sm font-semibold" data-i18n="badgeTitle"
            >오늘의 지혜</span
          >
          <span class="text-white/50 text-sm" data-i18n="badgeSubtitle">Daily Wisdom</span>
        </div>
        <h1 class="mt-4 text-3xl md:text-4xl font-extrabold tracking-tight" data-i18n="mainTitle">
          하루 한 문장
        </h1>
        <p class="mt-2 text-white/70" data-i18n="mainSubtitle">
          성경의 메시지에서 영감을 받은 하루 한 문장
        </p>
      </header>

      <!-- Today Card -->
      <section
        class="rounded-2xl bg-white/5 border border-white/10 p-6 shadow-lg"
      >
        <div class="flex items-start justify-between gap-4">
          <div class="min-w-0">
            <p class="text-sm text-white/60" data-i18n="todayLabel">오늘의 문장</p>
            <p
              id="todayText"
              class="mt-2 text-xl md:text-2xl font-bold leading-relaxed"
            ></p>
            <div class="mt-3 flex flex-wrap items-center gap-2">
              <span
                id="todayTheme"
                class="text-xs px-2 py-1 rounded-full bg-emerald-500/15 text-emerald-200 border border-emerald-500/20"
              ></span>
              <span
                class="text-xs px-2 py-1 rounded-full bg-white/5 text-white/60 border border-white/10"
              >
                <span data-i18n="todayNote">원문 인용 없이 재해석 문장</span>
              </span>
            </div>
          </div>
          <div class="shrink-0 flex flex-col gap-2">
            <button
              id="copyTodayBtn"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-emerald-500 hover:bg-emerald-400 text-slate-950 font-semibold transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-4 h-4"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M8 4h10a2 2 0 0 1 2 2v10"></path>
                <rect x="4" y="8" width="14" height="14" rx="2"></rect>
              </svg>
              <span data-i18n="copyButton">복사</span>
            </button>
            <button
              id="shareTodayBtn"
              class="inline-flex items-center gap-2 px-4 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-white font-semibold transition-colors"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="w-4 h-4"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="5" r="3"></circle>
                <circle cx="5" cy="19" r="3"></circle>
                <circle cx="19" cy="19" r="3"></circle>
                <path d="M8.59 17.51 15.42 13M8.59 6.49l6.83 4.02"></path>
              </svg>
              <span data-i18n="shareButton">공유하기</span>
            </button>
            <p class="text-xs text-white/50 leading-snug">
              <span data-i18n="shareHint">공유 시 오늘의 문장과 서비스 링크, 출처가 함께 전달됩니다.</span>
            </p>
          </div>
        </div>

        <div class="mt-5 grid grid-cols-1 md:grid-cols-3 gap-3">
          <div class="rounded-xl bg-black/20 border border-white/10 p-4">
            <p class="text-xs text-white/50" data-i18n="updateLabel">업데이트</p>
            <p id="todayDate" class="mt-1 font-semibold"></p>
          </div>
          <div class="rounded-xl bg-black/20 border border-white/10 p-4">
            <p class="text-xs text-white/50" data-i18n="countLabel">문장 수</p>
            <p class="mt-1 font-semibold"><span id="countText"></span><span data-i18n="countSuffix">개</span></p>
          </div>
          <div class="rounded-xl bg-black/20 border border-white/10 p-4">
            <p class="text-xs text-white/50" data-i18n="ruleLabel">랜덤 규칙</p>
            <p class="mt-1 font-semibold" data-i18n="ruleValue">날짜 기반 고정</p>
          </div>
        </div>
      </section>

      <!-- Controls -->
      <section class="mt-8 rounded-2xl bg-white/5 border border-white/10 p-6">
        <div class="flex flex-col md:flex-row md:items-end gap-4">
          <label class="flex-1">
            <span class="block text-sm text-white/70" data-i18n="searchLabel">검색</span>
            <input
              id="q"
              type="text"
              placeholder="예: 불안, 용기, 관계, 감사..."
              data-i18n-placeholder="searchPlaceholder"
              class="mt-2 w-full rounded-xl bg-black/20 border border-white/10 px-4 py-3 outline-none focus:ring-2 focus:ring-emerald-500/60 placeholder:text-white/40"
            />
          </label>

          <label class="md:w-56">
            <span class="block text-sm text-white/70" data-i18n="themeLabel">테마</span>
            <select
              id="theme"
              class="mt-2 w-full rounded-xl bg-black/20 border border-white/10 px-4 py-3 outline-none focus:ring-2 focus:ring-emerald-500/60"
            >
              <option value="" data-i18n="themeAll">전체</option>
            </select>
          </label>

          <div class="flex gap-3 md:w-auto">
            <button
              id="shuffleBtn"
              class="w-full md:w-auto px-4 py-3 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-white font-semibold transition-colors"
            >
              <span data-i18n="shuffleButton">오늘 다시 뽑기</span>
            </button>
            <button
              id="downloadBtn"
              class="w-full md:w-auto px-4 py-3 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-white font-semibold transition-colors"
            >
              <span data-i18n="downloadButton">700개 TXT</span>
            </button>
          </div>
        </div>

        <p class="mt-4 text-sm text-white/50">
          <span data-i18n="note">※ 이 서비스는 성경 번역문을 인용하지 않고, 메시지에서 영감을 받아 새로 작성한 문장만 제공합니다.</span>
        </p>
      </section>

      <!-- List -->
      <section class="mt-6">
        <div class="flex items-center justify-between mb-3">
          <h2 class="text-lg font-bold" data-i18n="listTitle">문장 모음</h2>
          <div class="text-sm text-white/60">
            <span id="resultCount"></span>
          </div>
        </div>

        <div id="list" class="grid grid-cols-1 gap-3"></div>

        <!-- Pagination -->
        <div class="mt-6 flex items-center justify-between">
          <button
            id="prevBtn"
            class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 disabled:opacity-40 disabled:hover:bg-white/10 transition-colors"
          >
            <span data-i18n="prevButton">이전</span>
          </button>
          <div class="text-sm text-white/60">
            <span id="pageInfo"></span>
          </div>
          <button
            id="nextBtn"
            class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 disabled:opacity-40 disabled:hover:bg-white/10 transition-colors"
          >
            <span data-i18n="nextButton">다음</span>
          </button>
        </div>
      </section>

      <!-- Other services button (exact style you gave) -->
      <div class="flex justify-center pt-8 mt-12 border-t border-gray-200/20">
        <a
          href="https://funnyfunny.cloud/"
          target="_blank"
          rel="noopener noreferrer"
          class="px-6 py-3 bg-gray-900 hover:bg-gray-800 text-white rounded-lg font-medium transition-colors duration-200"
          data-i18n="viewMore"
        >
          다른 서비스 보기
        </a>
      </div>

      <footer class="mt-6 text-center text-xs text-white/40">
        © <span id="year"></span> Daily Wisdom
      </footer>
    </main>

    <script>
      // ---------- 700 sentences generator (Korean, reinterpreted, not quotes) ----------
      const THEMES = [
        "평안",
        "용기",
        "사랑",
        "관계",
        "감사",
        "인내",
        "지혜",
        "겸손",
        "정직",
        "회복",
        "소망",
        "절제",
        "배려",
        "용서",
        "성실",
        "집중",
        "결단",
        "불안 다루기",
        "기쁨",
        "성장",
      ];

      // "좋은 문장"의 톤을 만들기 위한 조각들(직접 인용/번역 금지: 문장 구조를 독립적으로 설계)
      const OPENERS = [
        "오늘은",
        "때로는",
        "가끔은",
        "마음이 흔들릴수록",
        "길이 보이지 않을수록",
        "서두르고 싶을수록",
        "불안이 커질수록",
        "무너진 것 같을 때도",
        "조용한 순간에",
        "숨이 가쁠 때",
        "선택이 어렵다면",
        "관계가 멀게 느껴질 때",
        "실패가 떠오를 때",
        "눈앞이 어두울 때",
        "마음이 복잡할 때",
        "기다림이 길어질수록",
        "나를 탓하고 싶어질 때",
        "확신이 없을 때",
      ];

      const CORES = [
        "한 걸음만",
        "작은 친절을",
        "짧은 멈춤을",
        "지금 할 수 있는 한 가지를",
        "진심 한 마디를",
        "고개를 들어",
        "숨을 고르고",
        "마음을 다잡고",
        "시선을 바꾸어",
        "기준을 다시 세워",
        "조급함을 내려놓고",
        "원망 대신",
        "비교 대신",
        "두려움 대신",
        "핑계 대신",
        "회피 대신",
        "미움 대신",
        "완벽 대신",
      ];

      const ENDS = [
        "선택해도 괜찮다.",
        "해보면 길이 열린다.",
        "하면 마음이 정돈된다.",
        "하면 생각이 가벼워진다.",
        "하면 내일이 달라진다.",
        "하면 충분하다.",
        "하는 것이 용기다.",
        "하는 것이 사랑이다.",
        "하면 다시 시작할 수 있다.",
        "하면 방향이 선명해진다.",
        "하면 관계가 따뜻해진다.",
        "하면 불안이 줄어든다.",
        "하면 오늘이 살아난다.",
      ];

      const LINES = [
        "답은 빨리 오지 않아도, 길은 사라지지 않는다.",
        "마음이 지칠 땐 속도를 줄이는 것도 전진이다.",
        "말을 아끼는 날에도 마음은 자란다.",
        "확신이 없어도 성실함은 길을 만든다.",
        "지금의 작은 선택이 내일의 큰 평안을 부른다.",
        "기다림은 멈춤이 아니라 방향을 지키는 일이다.",
        "한 번의 친절이 하루의 온도를 바꾼다.",
        "불안은 상상으로 커지지만, 행동으로 줄어든다.",
        "관계는 ‘이기기’가 아니라 ‘이해하기’로 좋아진다.",
        "감사는 상황보다 시선을 바꾸는 힘이다.",
      ];

      function makeSentence(i) {
        // deterministic variety
        const t = THEMES[i % THEMES.length];
        const a = OPENERS[(i * 3) % OPENERS.length];
        const b = CORES[(i * 5 + 1) % CORES.length];
        const c = ENDS[(i * 7 + 2) % ENDS.length];
        const extra = i % 4 === 0 ? " " + LINES[(i / 4) % LINES.length] : "";
        // 문장 과도하게 성경투/번역투로 보이지 않게, 현대어 유지
        return {
          id: i + 1,
          theme: t,
          text: `${a} ${b} ${c}${extra}`.replace(/\s+/g, " ").trim(),
        };
      }

      // Build ~700 items
      const ALL = Array.from({ length: 700 }, (_, i) => makeSentence(i));

      // ---------- UI helpers ----------
      const $ = (id) => document.getElementById(id);

      function formatDateK(date) {
        const y = date.getFullYear();
        const m = String(date.getMonth() + 1).padStart(2, "0");
        const d = String(date.getDate()).padStart(2, "0");
        return `${y}.${m}.${d}`;
      }

      // Seeded daily index (stable per date)
      function dailyIndex(date, mod) {
        const y = date.getFullYear();
        const m = date.getMonth() + 1;
        const d = date.getDate();
        // simple deterministic hash
        let x = (y * 10000 + m * 100 + d) >>> 0;
        x = (x ^ 0x9e3779b9) >>> 0;
        x = Math.imul(x ^ (x >>> 16), 0x85ebca6b) >>> 0;
        x = Math.imul(x ^ (x >>> 13), 0xc2b2ae35) >>> 0;
        x = (x ^ (x >>> 16)) >>> 0;
        return x % mod;
      }

      async function copyText(text) {
        try {
          await navigator.clipboard.writeText(text);
          return true;
        } catch (_) {
          // fallback
          const ta = document.createElement("textarea");
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try {
            document.execCommand("copy");
          } catch (e) {}
          document.body.removeChild(ta);
          return true;
        }
      }

      // ---------- State ----------
      let filtered = [...ALL];
      let page = 1;
      const pageSize = 20;
      let todayItem = null;
      let shareBtnDefaultHtml = "";

      function renderThemes() {
        const sel = $("theme");
        if (!sel) {
          console.warn("Theme select element not found");
          return;
        }
        const uniq = [...new Set(ALL.map((x) => x.theme))];
        uniq.forEach((t) => {
          const opt = document.createElement("option");
          opt.value = t;
          opt.textContent = t;
          sel.appendChild(opt);
        });
      }

      function setToday(forceRandom = false) {
        if (!ALL.length) return;
        const now = new Date();
        const idx = forceRandom
          ? Math.floor(Math.random() * ALL.length)
          : dailyIndex(now, ALL.length);
        const item = ALL[idx];

        todayItem = item;
        
        const todayTextEl = $("todayText");
        const todayThemeEl = $("todayTheme");
        const todayDateEl = $("todayDate");
        
        if (todayTextEl) todayTextEl.textContent = item.text;
        if (todayThemeEl) todayThemeEl.textContent = t("themePrefix") + item.theme;
        if (todayDateEl) todayDateEl.textContent = formatDateK(now);

        const copyTodayBtnEl = $("copyTodayBtn");
        if (copyTodayBtnEl) {
          copyTodayBtnEl.onclick = async () => {
            const ok = await copyText(item.text);
            if (ok) {
              copyTodayBtnEl.textContent = t("copyDone");
              setTimeout(() => {
                copyTodayBtnEl.innerHTML = `
              <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M8 4h10a2 2 0 0 1 2 2v10"></path>
                <rect x="4" y="8" width="14" height="14" rx="2"></rect>
              </svg>
              ${t("copyButton")}
            `;
            }, 900);
          }
          };
        }
      }

      async function shareToday() {
        if (!todayItem) return;
        const btn = $("shareTodayBtn");
        const message = `${todayItem.text}\n\n${t("shareMessage")}`;
        try {
          if (navigator.share) {
            await navigator.share({
              title: t("badgeTitle"),
              text: message,
              url: "https://wisdom.funnyfunny.cloud/",
            });
            btn.textContent = t("shareDone");
          } else {
            await copyText(message);
            btn.textContent = t("linkCopied");
          }
        } catch (_) {
          await copyText(message);
          btn.textContent = t("linkCopied");
        }
        setTimeout(() => {
          btn.innerHTML = shareBtnDefaultHtml;
        }, 1000);
      }

      function applyFilter() {
        const qEl = $("q");
        const themeEl = $("theme");
        
        // Null 체크 추가
        if (!qEl || !themeEl) {
          console.warn("Filter elements not found");
          return;
        }
        
        const q = qEl.value.trim();
        const th = themeEl.value;

        filtered = ALL.filter((item) => {
          const okTheme = !th || item.theme === th;
          const okQ = !q || item.text.includes(q) || item.theme.includes(q);
          return okTheme && okQ;
        });

        page = 1;
        renderList();
      }

      function renderList() {
        const start = (page - 1) * pageSize;
        const items = filtered.slice(start, start + pageSize);

        const list = $("list");
        if (!list) return; // Early return if element doesn't exist yet
        list.innerHTML = "";

        items.forEach((item) => {
          const card = document.createElement("div");
          card.className =
            "rounded-2xl bg-white/5 border border-white/10 p-5 hover:border-emerald-400/40 transition-colors";

          card.innerHTML = `
          <div class="flex items-start justify-between gap-4">
            <div class="min-w-0">
              <div class="flex flex-wrap items-center gap-2">
                <span class="text-xs px-2 py-1 rounded-full bg-white/5 text-white/60 border border-white/10">#${
                  item.id
                }</span>
                <span class="text-xs px-2 py-1 rounded-full bg-emerald-500/15 text-emerald-200 border border-emerald-500/20">${
                  item.theme
                }</span>
              </div>
              <p class="mt-3 text-base md:text-lg font-semibold leading-relaxed">${escapeHtml(
                item.text
              )}</p>
            </div>
            <button class="copyBtn shrink-0 px-3 py-2 rounded-xl bg-white/10 hover:bg-white/15 border border-white/10 text-sm font-semibold transition-colors">
              ${t("copyButton")}
            </button>
          </div>
        `;

          const btn = card.querySelector(".copyBtn");
          if (btn) {
            // Update button text with current language
            btn.textContent = t("copyButton");
            btn.addEventListener("click", async () => {
              const ok = await copyText(item.text);
              if (ok) {
                btn.textContent = t("copyDone");
                setTimeout(() => (btn.textContent = t("copyButton")), 900);
              }
            });
          }

          list.appendChild(card);
        });

        // pagination
        const totalPages = Math.max(1, Math.ceil(filtered.length / pageSize));
        const prevBtn = $("prevBtn");
        const nextBtn = $("nextBtn");
        const pageInfo = $("pageInfo");
        const resultCount = $("resultCount");
        if (prevBtn) prevBtn.disabled = page <= 1;
        if (nextBtn) nextBtn.disabled = page >= totalPages;
        if (pageInfo) pageInfo.textContent = t("pageInfo", { page, total: totalPages });
        if (resultCount) resultCount.textContent = t("resultCount", { count: filtered.length });
      }

      function escapeHtml(str) {
        return str
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      function downloadTxt() {
        const lines = ALL.map((x) => `[${x.id}] (${x.theme}) ${x.text}`);
        const blob = new Blob([lines.join("\n")], {
          type: "text/plain;charset=utf-8",
        });
        const a = document.createElement("a");
        a.href = URL.createObjectURL(blob);
        a.download = "daily_wisdom_700.txt";
        a.click();
      }

      // ---------- i18n ----------
      const translations = {
        ko: {
          todayLabel: "오늘의 문장",
          todayNote: "원문 인용 없이 재해석 문장",
          copyButton: "복사",
          copyDone: "복사됨",
          shareButton: "공유하기",
          shareHint: "공유 시 오늘의 문장과 서비스 링크, 출처가 함께 전달됩니다.",
          updateLabel: "업데이트",
          countLabel: "문장 수",
          countSuffix: "개",
          ruleLabel: "랜덤 규칙",
          ruleValue: "날짜 기반 고정",
          searchLabel: "검색",
          searchPlaceholder: "예: 불안, 용기, 관계, 감사...",
          themeLabel: "테마",
          themeAll: "전체",
          shuffleButton: "오늘 다시 뽑기",
          downloadButton: "700개 TXT",
          note: "※ 이 서비스는 성경 번역문을 인용하지 않고, 메시지에서 영감을 받아 새로 작성한 문장만 제공합니다.",
          listTitle: "문장 모음",
          prevButton: "이전",
          nextButton: "다음",
          pageInfo: "{page} / {total}",
          resultCount: "{count}개",
          shareMessage: "오늘의 지혜 한 문장 - https://wisdom.funnyfunny.cloud/",
          badgeTitle: "오늘의 지혜",
          badgeSubtitle: "Daily Wisdom",
          mainTitle: "하루 한 문장",
          mainSubtitle: "성경의 메시지에서 영감을 받은 하루 한 문장",
          themePrefix: "테마: ",
          shareDone: "공유됨",
          linkCopied: "링크 복사됨",
          viewMore: "다른 서비스 보기",
        },
        en: {
          todayLabel: "Today's sentence",
          todayNote: "Reinterpreted sentence without original quote",
          copyButton: "Copy",
          copyDone: "Copied",
          shareButton: "Share",
          shareHint: "Sharing will include today's sentence, service link, and source.",
          updateLabel: "Update",
          countLabel: "Sentences",
          countSuffix: "",
          ruleLabel: "Random rule",
          ruleValue: "Date-based fixed",
          searchLabel: "Search",
          searchPlaceholder: "e.g., anxiety, courage, relationship, gratitude...",
          themeLabel: "Theme",
          themeAll: "All",
          shuffleButton: "Redraw today",
          downloadButton: "700 TXT",
          note: "※ This service does not quote Bible translations, but only provides newly written sentences inspired by the message.",
          listTitle: "Sentence collection",
          prevButton: "Previous",
          nextButton: "Next",
          pageInfo: "{page} / {total}",
          resultCount: "{count} items",
          shareMessage: "Today's wisdom sentence - https://wisdom.funnyfunny.cloud/",
          badgeTitle: "Today's Wisdom",
          badgeSubtitle: "Daily Wisdom",
          mainTitle: "One sentence a day",
          mainSubtitle: "One sentence a day inspired by biblical messages",
          themePrefix: "Theme: ",
          shareDone: "Shared",
          linkCopied: "Link copied",
          viewMore: "View other services",
        },
      };

      const defaultLang = "ko";
      const supportedLangs = ["ko", "en"];
      let currentLang = defaultLang;

      function t(key, vars = {}) {
        const langTable = translations[currentLang] || translations.ko;
        const template = langTable?.[key] ?? translations.ko?.[key] ?? key;
        if (typeof template !== "string") {
          return template;
        }
        return template.replace(/\{(\w+)\}/g, (_, token) =>
          vars[token] !== undefined ? vars[token] : `{${token}}`
        );
      }

      function applyTranslations() {
        document.title = currentLang === "ko" ? "오늘의 지혜 한 문장" : "Daily Wisdom";
        const desc = document.querySelector('meta[name="description"]');
        if (desc) {
          desc.setAttribute("content", currentLang === "ko" 
            ? "성경의 메시지에서 영감을 받은 하루 한 문장. 짧고 단단한 문장으로 하루를 정돈하세요."
            : "One sentence a day inspired by biblical messages. Organize your day with short and solid sentences.");
        }
        const keywords = document.querySelector('meta[name="keywords"]');
        if (keywords) {
          keywords.setAttribute("content", currentLang === "ko"
            ? "오늘의 지혜, 하루 한 문장, 묵상, 마음정리, 영감 문장"
            : "daily wisdom, one sentence a day, meditation, mind organization, inspirational sentences");
        }
        document.querySelectorAll("[data-i18n]").forEach((el) => {
          el.textContent = t(el.dataset.i18n);
        });
        document.querySelectorAll("[data-i18n-html]").forEach((el) => {
          el.innerHTML = t(el.dataset.i18nHtml);
        });
        document.querySelectorAll("[data-i18n-placeholder]").forEach((el) => {
          el.placeholder = t(el.dataset.i18nPlaceholder);
        });
      }

      function setLang(lang, options = {}) {
        const nextLang = translations[lang] ? lang : defaultLang;
        currentLang = nextLang;
        document.documentElement.lang = nextLang;
        localStorage.setItem("preferredLang", nextLang);
        document.querySelectorAll(".lang-switch button").forEach((button) => {
          button.classList.toggle("active", button.dataset.lang === nextLang);
        });
        applyTranslations();
        // Re-render list to update translations (only if list element exists)
        if ($("list")) {
          renderList();
        }
        // Update today section
        if (todayItem) {
          const todayThemeEl = $("todayTheme");
          if (todayThemeEl) todayThemeEl.textContent = t("themePrefix") + todayItem.theme;
        }
        if (options.updateUrl) {
          const url = new URL(window.location.href);
          url.searchParams.set("lang", nextLang);
          window.history.replaceState({}, "", url);
        }
      }

      function detectLang() {
        const params = new URLSearchParams(window.location.search);
        const paramLang = params.get("lang");
        if (supportedLangs.includes(paramLang)) return paramLang;
        const stored = localStorage.getItem("preferredLang");
        if (supportedLangs.includes(stored)) return stored;
        const browserLang =
          navigator.languages && navigator.languages.length
            ? navigator.languages[0]
            : navigator.language;
        if (browserLang && browserLang.toLowerCase().startsWith("ko")) {
          return "ko";
        }
        return defaultLang;
      }

      document.querySelectorAll(".lang-switch button").forEach((button) => {
        button.addEventListener("click", () => {
          setLang(button.dataset.lang, { updateUrl: true });
        });
      });

      // ---------- init ----------
      setLang(detectLang(), { updateUrl: false });
      
      // Wait for DOM to be ready
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', init);
      } else {
        init();
      }
      
      function init() {
        const yearEl = $("year");
        if (yearEl) yearEl.textContent = new Date().getFullYear();
        
        const countTextEl = $("countText");
        if (countTextEl) countTextEl.textContent = ALL.length;
        
        const shareTodayBtnEl = $("shareTodayBtn");
        if (shareTodayBtnEl) shareBtnDefaultHtml = shareTodayBtnEl.innerHTML;
        
        renderThemes();
        setToday(false);
        applyFilter();

        const qEl = $("q");
        if (qEl) qEl.addEventListener("input", applyFilter);
        
        const themeEl = $("theme");
        if (themeEl) themeEl.addEventListener("change", applyFilter);

        const prevBtn = $("prevBtn");
        if (prevBtn) prevBtn.addEventListener("click", () => {
          page--;
          renderList();
        });
        
        const nextBtn = $("nextBtn");
        if (nextBtn) nextBtn.addEventListener("click", () => {
          page++;
          renderList();
        });
        
        const shuffleBtn = $("shuffleBtn");
        if (shuffleBtn) shuffleBtn.addEventListener("click", () => setToday(true));
        
        const downloadBtn = $("downloadBtn");
        if (downloadBtn) downloadBtn.addEventListener("click", downloadTxt);
        
        const shareTodayBtn = $("shareTodayBtn");
        if (shareTodayBtn) shareTodayBtn.addEventListener("click", shareToday);
      }
    </script>
  
<ins class="adsbygoogle"
     style="display:block; text-align:center"
     data-ad-client="ca-pub-1204894220949193"
     data-ad-slot="5145068706"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
    
</body>
</html>
